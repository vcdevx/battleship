(()=>{"use strict";class t{constructor(t,e){this.length=t,this.sunk=!1,this.shipStatus=Array(t).fill(""),this.shipName=e}hit(t){if(t<0||t>=this.length)throw new Error("Invalid index");""===this.shipStatus[t]&&(this.shipStatus[t]="hit")}isSunk(){!0===this.shipStatus.every((t=>"hit"===t))&&(this.sunk=!0)}}let e=t=>Math.floor(Math.random()*t),s=()=>0==e(2)?"horizontal":"vertical";class i{constructor(t){this.board=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]],this.ships=[],this.name=t}placeShip(i,r,a,n,o){if("vertical"===n){if(r+i>10||!0===this.checkIfNotEmpty(i,r,a,n))return this.placeShip(i,e(10),e(10),s(),o);let h=new t(i);h.shipName=o,this.ships===[]?h.id=0:h.id=this.ships.length,this.ships.push(h);for(let t=0;t<i;t++){let e={shipIndex:void 0,shipID:h.id};if(""!==this.board[r+t][a])throw Error("ship can not be placed here vertically");e.shipIndex=t,this.board[r+t][a]=e}}if("horizontal"===n){if(a+i>10||!0===this.checkIfNotEmpty(i,r,a,n))return this.placeShip(i,e(10),e(10),s(),o);let h=new t(i);h.shipName=o,this.ships===[]?h.id=0:h.id=this.ships.length,this.ships.push(h);for(let t=0;t<i;t++){let e={shipIndex:void 0,shipID:h.id};if(""!==this.board[r][a+t])throw Error("ship can not be placed here horizontally");e.shipIndex=t,this.board[r][a+t]=e}}}receiveAttack(t,e){""===this.board[t][e]?this.board[t][e]="miss":"miss"==this.board[t][e]&&""==this.board[t][e]||this.ships[this.board[t][e].shipID].hit(this.board[t][e].shipIndex)}checkShipStatus(){return!!this.ships.every((t=>1==t.sunk))}checkIfNotEmpty(t,e,s,i){let r=!1;if("horizontal"===i&&void 0!==e){for(let i=0;i<t+1;i++)if(""!==this.board[e][s+i]){r=!0;break}return r}if("vertical"===i){let i=!1;for(let r=0;r<t;r++)if(""!==this.board[e+r][s]){i=!0;break}return i}}checkIfLost(){return this.ships.every((t=>1==t.sunk))}checkForNoHit(t,e){if(""===this.board[t][e])return!0;if("miss"!==this.board[t][e]&&""!==this.board[t][e]){if("miss"!==this.board[t][e]&&""===this.board[t][e])return!0;if("hit"!==this.ships[this.board[t][e].shipID].shipStatus[this.board[t][e].shipIndex])return!0;u()}else u()}clearShips(){this.ships=[],this.board=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]]}}class r{constructor(t){this.name=t,this.turn=!0}getName(){return this.name}setName(t){this.name=t}endTurn(t){1==this.turn&&(this.turn=!1,t.startTurn())}startTurn(){0==this.turn&&(this.turn=!0)}checkTurn(){return this.turn}attack(t,e,s,i){this.checkTurn()&&(i.receiveAttack(t,e),this.endTurn(s))}}const a=new r("player"),n=new r("ai"),o=new i("player"),h=new i("ai"),l=t=>{let e=document.querySelector(".playerBoardContainer"),s=document.querySelector(".aiBoardContainer");for(let i=0;i<t.board.length;i++)for(let r=0;r<t.board[i].length;r++){let a=document.createElement("div");a.classList.add("cell"),a.setAttribute("data-row",i),a.setAttribute("data-col",r),"player"==t.name?a.classList.add("playerCell"):"ai"==t.name&&a.classList.add("aiCell"),""!=t.board[i][r]&&"miss"!=t.board[i][r]&&("hit"===t.ships[t.board[i][r].shipID].shipStatus[t.board[i][r].shipIndex]&&(a.classList.remove("shipCell"),a.classList.add("hitCell")),0==t.ships[t.board[i][r].shipID].sunk?a.classList.add("shipCell"):1==t.ships[t.board[i][r].shipID].sunk&&a.classList.add("sunkCell")),"miss"===t.board[i][r]&&a.classList.add("missCell"),"player"==t.name?e.append(a):"ai"==t.name&&s.append(a)}};let d=t=>{let i=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],r=[5,4,3,3,2];for(let a=0;a<5;a++)t.placeShip(r[a],e(10),e(10),s(),i[a])};const c=(t,e,s)=>{let i=document.querySelector(".gameStatus");i.textContent="Player's Turn",1==e.turn&&document.querySelectorAll(".aiCell").forEach((t=>{t.addEventListener("click",(t=>{if(!t.target.classList.contains("hitCell")&&!t.target.classList.contains("missCell")){let e=t.target.getAttribute("data-row"),s=t.target.getAttribute("data-col");h.receiveAttack(e,s),""!==h.board[e][s]&&"miss"!==h.board[e][s]&&h.ships[h.board[e][s].shipID].isSunk(),p("ai"),l(h),1==h.checkIfLost()?m("Player"):(a.endTurn(n),i.textContent="Enemy's Turn",setTimeout(u,1500))}}))}))},u=(t=e(10),s=e(10))=>{if(1==o.checkForNoHit(t,s)){if(o.receiveAttack(t,s),""!==o.board[t][s]&&"miss"!==o.board[t][s]&&o.ships[o.board[t][s].shipID].isSunk(),p("player"),l(o),1==o.checkIfLost())return m("Enemy");n.endTurn(a),c(0,a)}},p=t=>{"ai"==t?document.querySelector(".aiBoardContainer").innerHTML="":"player"==t&&(document.querySelector(".playerBoardContainer").innerHTML="")},m=t=>{a.turn=!1;let e=document.querySelector(".gameStatusContainer"),s=document.querySelector(".gameStatus");e.style.flexDirection="column",s.textContent=`${t} wins!`;let i=document.createElement("button");i.classList.add("reloadGameBtn"),i.textContent="Reload Game",e.append(i),i.addEventListener("click",y)},b=()=>{let t=document.createElement("button"),e=document.querySelector(".gameStatus");t.classList.add("resetBoardBtn"),t.textContent="Reset Board",e.append(t);let s=document.querySelector(".gameStatusContainer");s.style.flexDirection="row",t.addEventListener("click",(()=>{p("player"),o.clearShips(),d(o),l(o);let e=document.createElement("button");e.classList.add("startBtn"),e.textContent="Start Game",s.innerHTML="";let i=document.createElement("h3");i.classList.add("gameStatus"),i.textContent="",s.append(i),s.append(t),s.append(e),(()=>{let t=document.querySelector(".startBtn"),e=document.querySelector(".resetBoardBtn");document.querySelector(".gameStatus"),t.addEventListener("click",(()=>{t.style.display="none",e.style.display="none",d(h),p("ai"),l(h),a.startTurn(),c(0,a)}))})()}))},y=()=>{let t=document.querySelector(".gameStatusContainer");t.innerHTML="";let e=document.createElement("h3");e.classList.add("gameStatus"),e.textContent="",t.append(e),o.clearShips(),h.clearShips(),b(),p("player"),p("ai"),l(o),l(h)};b(),l(o),l(h)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVUMsSUFBSSxZQUMzQjZCLEVBQWFuQixZQUFjLGFBQzNCWSxFQUFvQkYsVUFBWSxHQUVoQyxJQUFJWCxFQUFhaEIsU0FBU0ssY0FBYyxNQUN4Q1csRUFBV1YsVUFBVUMsSUFBSSxjQUN6QlMsRUFBV0MsWUFBYyxHQUV6QlksRUFBb0JuQixPQUFPTSxHQUUzQmEsRUFBb0JuQixPQUFPeUIsR0FDM0JOLEVBQW9CbkIsT0FBTzBCLEdBaEdqQixNQUNkLElBQUlBLEVBQWVwQyxTQUFTQyxjQUFjLGFBQ3RDa0MsRUFBZ0JuQyxTQUFTQyxjQUFjLGtCQUVqQkQsU0FBU0MsY0FBYyxlQUVqRG1DLEVBQWFoQixpQkFBaUIsU0FBUyxLQUNuQ2dCLEVBQWFOLE1BQU1PLFFBQVUsT0FDN0JGLEVBQWNMLE1BQU1PLFFBQVUsT0FDOUIxQixFQUFtQmYsR0FDbkI0QixFQUFXLE1BQ1gzQixFQUFhRCxHQUNiSCxFQUFPUCxZQUNQNEIsRUFBYWxCLEVBQVNILEVBQVUsR0FDbkMsRUFtRkc2QyxFQUFXLEdBQ2QsRUFHQ0wsRUFBWSxLQUNkLElBQUlKLEVBQXNCN0IsU0FBU0MsY0FBYyx3QkFDakQ0QixFQUFvQkYsVUFBWSxHQUVoQyxJQUFJWCxFQUFhaEIsU0FBU0ssY0FBYyxNQUN4Q1csRUFBV1YsVUFBVUMsSUFBSSxjQUN6QlMsRUFBV0MsWUFBYyxHQUV6QlksRUFBb0JuQixPQUFPTSxHQUczQnJCLEVBQVloQixhQUNaaUIsRUFBUWpCLGFBQ1J1RCxJQUVBVixFQUFXLFVBQ1hBLEVBQVcsTUFDWDNCLEVBQWFGLEdBQ2JFLEVBQWFELEVBQU8sRUM1TnhCc0MsSUFDQXJDLEVBQWFGLEdBQ2JFLEVBQWFELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9oZWxwZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgU2hpcCB7XHJcbiAgICBjb25zdHJ1Y3RvcihudW0sIHNoaXBOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSBudW07XHJcbiAgICAgICAgdGhpcy5zdW5rID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zaGlwU3RhdHVzID0gQXJyYXkobnVtKS5maWxsKFwiXCIpO1xyXG4gICAgICAgIHRoaXMuc2hpcE5hbWUgPSBzaGlwTmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBoaXQoaW5kZXgpIHtcclxuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbmRleCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zaGlwU3RhdHVzW2luZGV4XSA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGlwU3RhdHVzW2luZGV4XSA9ICdoaXQnXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzU3VuaygpIHtcclxuICAgICAgICBpZiAodGhpcy5zaGlwU3RhdHVzLmV2ZXJ5KGhpdCA9PiBoaXQgPT09ICdoaXQnKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN1bmsgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgU2hpcCB9IiwibGV0IHJhbmRvbU51bWJlciA9IChudW0pID0+IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bSk7XHJcbmxldCByYW5kb21EaXJlY3Rpb24gPSAoKSA9PiB7XHJcbiAgICBpZiAocmFuZG9tTnVtYmVyKDIpID09IDApIHtcclxuICAgICAgICByZXR1cm4gJ2hvcml6b250YWwnXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAndmVydGljYWwnXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHJlZnJlc2hQYWdlID0gKCkgPT4ge1xyXG4gICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHJhbmRvbU51bWJlciwgcmFuZG9tRGlyZWN0aW9uLCByZWZyZXNoUGFnZSB9IiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IHsgcmFuZG9tTnVtYmVyLCByYW5kb21EaXJlY3Rpb24gfSBmcm9tIFwiLi9oZWxwZXJcIjtcclxuaW1wb3J0IHsgcGxheWVyQm9hcmQsIGFpQXR0YWNrIH0gZnJvbSBcIi4vZ2FtZVwiO1xyXG5cclxuY2xhc3MgR2FtZWJvYXJkIHtcclxuICBjb25zdHJ1Y3RvcihuYW1lKSB7XHJcbiAgICB0aGlzLmJvYXJkID0gW1xyXG4gICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICBdO1xyXG4gICAgdGhpcy5zaGlwcyA9IFtdO1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICB9XHJcblxyXG4gIHBsYWNlU2hpcChsZW5ndGgsIHJvdywgY29sLCBkaXJlY3Rpb24sIHNoaXBOYW1lKSB7XHJcbiAgICBpZiAoZGlyZWN0aW9uID09PSBcInZlcnRpY2FsXCIpIHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIHJvdyArIGxlbmd0aCA+IDEwIHx8XHJcbiAgICAgICAgdGhpcy5jaGVja0lmTm90RW1wdHkobGVuZ3RoLCByb3csIGNvbCwgZGlyZWN0aW9uKSA9PT0gdHJ1ZVxyXG4gICAgICApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wbGFjZVNoaXAoXHJcbiAgICAgICAgICBsZW5ndGgsXHJcbiAgICAgICAgICByYW5kb21OdW1iZXIoMTApLFxyXG4gICAgICAgICAgcmFuZG9tTnVtYmVyKDEwKSxcclxuICAgICAgICAgIHJhbmRvbURpcmVjdGlvbigpLFxyXG4gICAgICAgICAgc2hpcE5hbWVcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGNyZWF0ZSBuZXcgc2hpcCBhbmQgcHVzaCBpdCBpbnRvIHNoaXAgYXJyYXlcclxuICAgICAgbGV0IGN1cnJlbnRTaGlwID0gbmV3IFNoaXAobGVuZ3RoKTtcclxuICAgICAgY3VycmVudFNoaXAuc2hpcE5hbWUgPSBzaGlwTmFtZTtcclxuICAgICAgaWYgKHRoaXMuc2hpcHMgPT09IFtdKSB7XHJcbiAgICAgICAgY3VycmVudFNoaXAuaWQgPSAwO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN1cnJlbnRTaGlwLmlkID0gdGhpcy5zaGlwcy5sZW5ndGg7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zaGlwcy5wdXNoKGN1cnJlbnRTaGlwKTtcclxuICAgICAgLy8gYWRkIHNoaXAgdG8gYm9hcmRcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBzaGlwID0geyBzaGlwSW5kZXg6IHVuZGVmaW5lZCwgc2hpcElEOiBjdXJyZW50U2hpcC5pZCB9O1xyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3JvdyArIGldW2NvbF0gPT09IFwiXCIpIHtcclxuICAgICAgICAgIHNoaXAuc2hpcEluZGV4ID0gaTtcclxuICAgICAgICAgIHRoaXMuYm9hcmRbcm93ICsgaV1bY29sXSA9IHNoaXA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRocm93IEVycm9yKFwic2hpcCBjYW4gbm90IGJlIHBsYWNlZCBoZXJlIHZlcnRpY2FsbHlcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZGlyZWN0aW9uID09PSBcImhvcml6b250YWxcIikge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgY29sICsgbGVuZ3RoID4gMTAgfHxcclxuICAgICAgICB0aGlzLmNoZWNrSWZOb3RFbXB0eShsZW5ndGgsIHJvdywgY29sLCBkaXJlY3Rpb24pID09PSB0cnVlXHJcbiAgICAgICkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBsYWNlU2hpcChcclxuICAgICAgICAgIGxlbmd0aCxcclxuICAgICAgICAgIHJhbmRvbU51bWJlcigxMCksXHJcbiAgICAgICAgICByYW5kb21OdW1iZXIoMTApLFxyXG4gICAgICAgICAgcmFuZG9tRGlyZWN0aW9uKCksXHJcbiAgICAgICAgICBzaGlwTmFtZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gY3JlYXRlIG5ldyBzaGlwIGFuZCBwdXNoIGl0IGludG8gc2hpcCBhcnJheVxyXG4gICAgICBsZXQgY3VycmVudFNoaXAgPSBuZXcgU2hpcChsZW5ndGgpO1xyXG4gICAgICBjdXJyZW50U2hpcC5zaGlwTmFtZSA9IHNoaXBOYW1lO1xyXG4gICAgICBpZiAodGhpcy5zaGlwcyA9PT0gW10pIHtcclxuICAgICAgICBjdXJyZW50U2hpcC5pZCA9IDA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY3VycmVudFNoaXAuaWQgPSB0aGlzLnNoaXBzLmxlbmd0aDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNoaXBzLnB1c2goY3VycmVudFNoaXApO1xyXG4gICAgICAvLyBhZGQgc2hpcCB0byBib2FyZFxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHNoaXAgPSB7IHNoaXBJbmRleDogdW5kZWZpbmVkLCBzaGlwSUQ6IGN1cnJlbnRTaGlwLmlkIH07XHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbcm93XVtjb2wgKyBpXSA9PT0gXCJcIikge1xyXG4gICAgICAgICAgc2hpcC5zaGlwSW5kZXggPSBpO1xyXG4gICAgICAgICAgdGhpcy5ib2FyZFtyb3ddW2NvbCArIGldID0gc2hpcDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhyb3cgRXJyb3IoXCJzaGlwIGNhbiBub3QgYmUgcGxhY2VkIGhlcmUgaG9yaXpvbnRhbGx5XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVjZWl2ZUF0dGFjayhyb3csIGNvbCkge1xyXG4gICAgaWYgKHRoaXMuYm9hcmRbcm93XVtjb2xdID09PSBcIlwiKSB7XHJcbiAgICAgIHRoaXMuYm9hcmRbcm93XVtjb2xdID0gXCJtaXNzXCI7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuYm9hcmRbcm93XVtjb2xdICE9IFwibWlzc1wiIHx8IHRoaXMuYm9hcmRbcm93XVtjb2xdICE9IFwiXCIpIHtcclxuICAgICAgdGhpcy5zaGlwc1t0aGlzLmJvYXJkW3Jvd11bY29sXS5zaGlwSURdLmhpdChcclxuICAgICAgICB0aGlzLmJvYXJkW3Jvd11bY29sXS5zaGlwSW5kZXhcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNoZWNrU2hpcFN0YXR1cygpIHtcclxuICAgIGlmICh0aGlzLnNoaXBzLmV2ZXJ5KChlbGVtZW50KSA9PiBlbGVtZW50LnN1bmsgPT0gdHJ1ZSkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tJZk5vdEVtcHR5KGxlbmd0aCwgcm93LCBjb2wsIGRpcmVjdGlvbikge1xyXG4gICAgbGV0IHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJob3Jpem9udGFsXCIgJiYgcm93ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGggKyAxOyBpKyspIHtcclxuICAgICAgICBpZiAodGhpcy5ib2FyZFtyb3ddW2NvbCArIGldICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICByZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiKSB7XHJcbiAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3JvdyArIGldW2NvbF0gIT09IFwiXCIpIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNoZWNrSWZMb3N0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2hpcHMuZXZlcnkoKGUpID0+IGUuc3VuayA9PSB0cnVlKTtcclxuICB9XHJcblxyXG4gIGNoZWNrRm9yTm9IaXQocm93LCBjb2wpIHtcclxuICAgIGlmICh0aGlzLmJvYXJkW3Jvd11bY29sXSA9PT0gXCJcIikge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5ib2FyZFtyb3ddW2NvbF0gIT09IFwibWlzc1wiICYmIHRoaXMuYm9hcmRbcm93XVtjb2xdICE9PSBcIlwiKSB7XHJcbiAgICAgIGlmICh0aGlzLmJvYXJkW3Jvd11bY29sXSAhPT0gXCJtaXNzXCIgJiYgdGhpcy5ib2FyZFtyb3ddW2NvbF0gPT09IFwiXCIpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICB0aGlzLnNoaXBzW3RoaXMuYm9hcmRbcm93XVtjb2xdLnNoaXBJRF0uc2hpcFN0YXR1c1tcclxuICAgICAgICAgIHRoaXMuYm9hcmRbcm93XVtjb2xdLnNoaXBJbmRleFxyXG4gICAgICAgIF0gIT09IFwiaGl0XCJcclxuICAgICAgKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYWlBdHRhY2soKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWlBdHRhY2soKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsZWFyU2hpcHMoKSB7XHJcbiAgICB0aGlzLnNoaXBzID0gW107XHJcbiAgICB0aGlzLmJvYXJkID0gW1xyXG4gICAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgICBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0sXHJcbiAgICAgICAgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdLFxyXG4gICAgICAgIFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSxcclxuICAgICAgXTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEdhbWVib2FyZCB9O1xyXG4iLCJjbGFzcyBQbGF5ZXIge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLnR1cm4gPSB0cnVlO1xyXG4gIH1cclxuICBnZXROYW1lKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubmFtZTtcclxuICB9XHJcbiAgc2V0TmFtZShuYW1lKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gIH1cclxuICBlbmRUdXJuKHBsYXllcjIpIHtcclxuICAgIGlmICh0aGlzLnR1cm4gPT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLnR1cm4gPSBmYWxzZTtcclxuICAgICAgcGxheWVyMi5zdGFydFR1cm4oKTtcclxuICAgIH1cclxuICB9XHJcbiAgc3RhcnRUdXJuKCkge1xyXG4gICAgaWYgKHRoaXMudHVybiA9PSBmYWxzZSkge1xyXG4gICAgICB0aGlzLnR1cm4gPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuICBjaGVja1R1cm4oKSB7XHJcbiAgICByZXR1cm4gdGhpcy50dXJuO1xyXG4gIH1cclxuICBhdHRhY2soeCwgeSwgdGFyZ2V0UGxheWVyLCB0YXJnZXRCb2FyZCkge1xyXG4gICAgaWYgKHRoaXMuY2hlY2tUdXJuKCkpIHtcclxuICAgICAgdGFyZ2V0Qm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcclxuICAgICAgdGhpcy5lbmRUdXJuKHRhcmdldFBsYXllcik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBQbGF5ZXIgfSIsImltcG9ydCB7IEdhbWVib2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgcmFuZG9tRGlyZWN0aW9uLCByYW5kb21OdW1iZXIsIHJlZnJlc2hQYWdlIH0gZnJvbSBcIi4vaGVscGVyXCI7XHJcblxyXG5jb25zdCBwbGF5ZXIgPSBuZXcgUGxheWVyKCdwbGF5ZXInKTtcclxuY29uc3QgYWkgPSBuZXcgUGxheWVyKCdhaScpO1xyXG5cclxuY29uc3QgcGxheWVyQm9hcmQgPSBuZXcgR2FtZWJvYXJkKCdwbGF5ZXInKTtcclxuY29uc3QgYWlCb2FyZCAgPSBuZXcgR2FtZWJvYXJkKCdhaScpO1xyXG5cclxuY29uc3QgZGlzcGxheUJvYXJkID0gKGdhbWVib2FyZCkgPT4ge1xyXG5cclxuICAgIGxldCBwbGF5ZXJCb2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJCb2FyZENvbnRhaW5lcicpO1xyXG4gICAgbGV0IGFpQm9hcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWlCb2FyZENvbnRhaW5lcicpO1xyXG5cclxuICAgIGZvciAobGV0IGggPSAwOyBoIDwgZ2FtZWJvYXJkLmJvYXJkLmxlbmd0aDsgaCsrKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lYm9hcmQuYm9hcmRbaF0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcclxuICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnZGF0YS1yb3cnLCBoKVxyXG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLWNvbCcsIGkpXHJcblxyXG4gICAgICAgIC8vIGNoYW5nZSBjb2xvciBvZiBib2FyZCBiYXNlZCBvbiB3aG8gdGhlIHBsYXllciBpc1xyXG4gICAgICAgIGlmIChnYW1lYm9hcmQubmFtZSA9PSAncGxheWVyJykge1xyXG4gICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ3BsYXllckNlbGwnKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGdhbWVib2FyZC5uYW1lID09ICdhaScpIHtcclxuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdhaUNlbGwnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChnYW1lYm9hcmQuYm9hcmRbaF1baV0gIT0gJycgJiYgZ2FtZWJvYXJkLmJvYXJkW2hdW2ldICE9ICdtaXNzJykge1xyXG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLnNoaXBzW2dhbWVib2FyZC5ib2FyZFtoXVtpXS5zaGlwSURdLnNoaXBTdGF0dXNbZ2FtZWJvYXJkLmJvYXJkW2hdW2ldLnNoaXBJbmRleF0gPT09ICdoaXQnKSB7XHJcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaXBDZWxsJylcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGl0Q2VsbCcpXHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLnNoaXBzW2dhbWVib2FyZC5ib2FyZFtoXVtpXS5zaGlwSURdLnN1bmsgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnc2hpcENlbGwnKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGdhbWVib2FyZC5zaGlwc1tnYW1lYm9hcmQuYm9hcmRbaF1baV0uc2hpcElEXS5zdW5rID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnc3Vua0NlbGwnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKGdhbWVib2FyZC5ib2FyZFtoXVtpXSA9PT0gJ21pc3MnKSB7XHJcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzc0NlbGwnKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoZ2FtZWJvYXJkLm5hbWUgPT0gJ3BsYXllcicpIHtcclxuICAgICAgICAgICAgcGxheWVyQm9hcmRDb250YWluZXIuYXBwZW5kKGNlbGwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZ2FtZWJvYXJkLm5hbWUgPT0gJ2FpJykge1xyXG4gICAgICAgICAgICBhaUJvYXJkQ29udGFpbmVyLmFwcGVuZChjZWxsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxubGV0IHJhbmRvbWx5UGxhY2VTaGlwcyA9IChnYW1lYm9hcmQpID0+IHtcclxuICAgIGxldCBzaGlwTmFtZXMgPSBbXCJDYXJyaWVyXCIsIFwiQmF0dGxlc2hpcFwiLCBcIkNydWlzZXJcIiwgXCJTdWJtYXJpbmVcIiwgXCJEZXN0cm95ZXJcIl1cclxuICAgIGxldCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBMZW5ndGhzW2ldLCByYW5kb21OdW1iZXIoMTApLCByYW5kb21OdW1iZXIoMTApLCByYW5kb21EaXJlY3Rpb24oKSwgc2hpcE5hbWVzW2ldKVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBwbGF5ZXJBdHRhY2sgPSAoZ2FtZWJvYXJkLCBwbGF5ZXIxLCBwbGF5ZXIyKSA9PiB7XHJcbiAgICBsZXQgZ2FtZVN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lU3RhdHVzJylcclxuICAgIGdhbWVTdGF0dXMudGV4dENvbnRlbnQgPSBcIlBsYXllcidzIFR1cm5cIlxyXG5cclxuICAgIGlmIChwbGF5ZXIxLnR1cm4gPT0gdHJ1ZSkge1xyXG5cclxuICAgICAgICBsZXQgYWlDZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFpQ2VsbCcpXHJcbiAgICAgICAgXHJcblxyXG5cclxuICAgICAgICBhaUNlbGwuZm9yRWFjaChjZWxsID0+IHtcclxuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaXRDZWxsJykgJiYgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWlzc0NlbGwnKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1yb3cnKVxyXG4gICAgICAgICAgICAgICAgbGV0IGNvbCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1jb2wnKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGFpQm9hcmQucmVjZWl2ZUF0dGFjayhyb3csIGNvbClcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYWlCb2FyZC5ib2FyZFtyb3ddW2NvbF0gIT09ICcnICYmIGFpQm9hcmQuYm9hcmRbcm93XVtjb2xdICE9PSAnbWlzcycpIHtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBhaUJvYXJkLnNoaXBzW2FpQm9hcmQuYm9hcmRbcm93XVtjb2xdLnNoaXBJRF0uaXNTdW5rKClcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjbGVhckJvYXJkKCdhaScpXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Qm9hcmQoYWlCb2FyZClcclxuICAgICAgICAgICAgICAgIGlmIChhaUJvYXJkLmNoZWNrSWZMb3N0KCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlXaW5uZXIoJ1BsYXllcicpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5lbmRUdXJuKGFpKVxyXG4gICAgICAgICAgICAgICAgICAgIGdhbWVTdGF0dXMudGV4dENvbnRlbnQgPSBcIkVuZW15J3MgVHVyblwiXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChhaUF0dGFjaywgMTUwMClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IHN0YXJ0R2FtZSA9ICgpID0+IHtcclxuICAgIGxldCBzdGFydEdhbWVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RhcnRCdG4nKVxyXG4gICAgbGV0IHJlc2V0Qm9hcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzZXRCb2FyZEJ0bicpXHJcbiAgICBcclxuICAgIGxldCBnYW1lU3RhdHVzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVTdGF0dXMnKVxyXG5cclxuICAgIHN0YXJ0R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBzdGFydEdhbWVCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICByZXNldEJvYXJkQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgcmFuZG9tbHlQbGFjZVNoaXBzKGFpQm9hcmQpOyBcclxuICAgICAgICBjbGVhckJvYXJkKCdhaScpXHJcbiAgICAgICAgZGlzcGxheUJvYXJkKGFpQm9hcmQpO1xyXG4gICAgICAgIHBsYXllci5zdGFydFR1cm4oKVxyXG4gICAgICAgIHBsYXllckF0dGFjayhhaUJvYXJkLCBwbGF5ZXIsIGFpKVxyXG4gICAgfSlcclxufVxyXG5cclxuXHJcbmNvbnN0IGFpQXR0YWNrID0gKHJvdyA9IHJhbmRvbU51bWJlcigxMCksIGNvbCA9IHJhbmRvbU51bWJlcigxMCkpID0+IHtcclxuXHJcblxyXG4gICAgaWYgKHBsYXllckJvYXJkLmNoZWNrRm9yTm9IaXQocm93LCBjb2wpID09IHRydWUpIHtcclxuICAgIHBsYXllckJvYXJkLnJlY2VpdmVBdHRhY2socm93LCBjb2wpXHJcbiAgICBpZiAocGxheWVyQm9hcmQuYm9hcmRbcm93XVtjb2xdICE9PSAnJyAmJiBwbGF5ZXJCb2FyZC5ib2FyZFtyb3ddW2NvbF0gIT09ICdtaXNzJykge1xyXG4gICAgICAgIHBsYXllckJvYXJkLnNoaXBzW3BsYXllckJvYXJkLmJvYXJkW3Jvd11bY29sXS5zaGlwSURdLmlzU3VuaygpXHJcbiAgICB9XHJcbiAgICBjbGVhckJvYXJkKCdwbGF5ZXInKVxyXG4gICAgZGlzcGxheUJvYXJkKHBsYXllckJvYXJkKVxyXG4gICAgaWYgKHBsYXllckJvYXJkLmNoZWNrSWZMb3N0KCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgIHJldHVybiBkaXNwbGF5V2lubmVyKCdFbmVteScpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFpLmVuZFR1cm4ocGxheWVyKVxyXG4gICAgICAgIHBsYXllckF0dGFjayhhaUJvYXJkLCBwbGF5ZXIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IGNsZWFyQm9hcmQgPSAoYm9hcmQpID0+IHtcclxuICAgIGlmIChib2FyZCA9PSAnYWknKSB7XHJcbiAgICBsZXQgYWlCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5haUJvYXJkQ29udGFpbmVyJylcclxuICAgIGFpQm9hcmQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICB9IGVsc2UgaWYgKGJvYXJkID09ICdwbGF5ZXInKSB7XHJcbiAgICAgICAgbGV0IHBsYXllckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllckJvYXJkQ29udGFpbmVyJylcclxuICAgICAgICBwbGF5ZXJCb2FyZC5pbm5lckhUTUwgPSAnJztcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgZGlzcGxheVdpbm5lciA9IChwbGF5ZXJOYW1lKSA9PiB7XHJcbiAgICBwbGF5ZXIudHVybiA9IGZhbHNlO1xyXG4gICAgbGV0IGdhbWVTdGF0dXNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZVN0YXR1c0NvbnRhaW5lcicpO1xyXG4gICAgbGV0IGdhbWVTdGF0dXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZVN0YXR1cycpXHJcblxyXG4gICAgZ2FtZVN0YXR1c0NvbnRhaW5lci5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ2NvbHVtbic7XHJcbiAgICBnYW1lU3RhdHVzLnRleHRDb250ZW50ID0gYCR7cGxheWVyTmFtZX0gd2lucyFgXHJcblxyXG4gICAgbGV0IHJlbG9hZEdhbWVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxyXG4gICAgcmVsb2FkR2FtZUJ0bi5jbGFzc0xpc3QuYWRkKCdyZWxvYWRHYW1lQnRuJylcclxuICAgIHJlbG9hZEdhbWVCdG4udGV4dENvbnRlbnQgPSAnUmVsb2FkIEdhbWUnXHJcbiAgICBnYW1lU3RhdHVzQ29udGFpbmVyLmFwcGVuZChyZWxvYWRHYW1lQnRuKVxyXG5cclxuICAgIC8vIGZ1bmN0aW9uIHRvIHJlbG9hZCBzY3JlZW4gaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGdhbWVcclxuICAgIHJlbG9hZEdhbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXNldEdhbWUpXHJcbn1cclxuXHJcbi8vIFJlc2V0IHBsYXllcidzIGJvYXJkIHdpdGggYSBidXR0b25cclxuY29uc3QgcmVzZXRQbGF5ZXJCb2FyZCA9ICgpID0+IHtcclxuICAgIGxldCByZXNldEJvYXJkQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcclxuICAgIGxldCBnYW1lU3RhdHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVTdGF0dXMnKVxyXG4gICAgcmVzZXRCb2FyZEJ0bi5jbGFzc0xpc3QuYWRkKCdyZXNldEJvYXJkQnRuJylcclxuICAgIHJlc2V0Qm9hcmRCdG4udGV4dENvbnRlbnQgPSAnUmVzZXQgQm9hcmQnXHJcbiAgICBnYW1lU3RhdHVzLmFwcGVuZChyZXNldEJvYXJkQnRuKVxyXG5cclxuICAgIGxldCBnYW1lU3RhdHVzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVTdGF0dXNDb250YWluZXInKVxyXG4gICAgZ2FtZVN0YXR1c0NvbnRhaW5lci5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ3JvdydcclxuICAgIFxyXG5cclxuICAgIHJlc2V0Qm9hcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgY2xlYXJCb2FyZCgncGxheWVyJylcclxuICAgICAgICBwbGF5ZXJCb2FyZC5jbGVhclNoaXBzKClcclxuICAgICAgICByYW5kb21seVBsYWNlU2hpcHMocGxheWVyQm9hcmQpXHJcbiAgICAgICAgZGlzcGxheUJvYXJkKHBsYXllckJvYXJkKVxyXG5cclxuICAgICAgICAvLyBSZW5kZXIgc3RhcnQgZ2FtZSBidXR0b24gb24gcGxheWVyJ3Mgc2NyZWVuXHJcbiAgICAgICAgbGV0IHN0YXJ0R2FtZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpXHJcbiAgICAgICAgc3RhcnRHYW1lQnRuLmNsYXNzTGlzdC5hZGQoJ3N0YXJ0QnRuJylcclxuICAgICAgICBzdGFydEdhbWVCdG4udGV4dENvbnRlbnQgPSAnU3RhcnQgR2FtZSdcclxuICAgICAgICBnYW1lU3RhdHVzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnXHJcblxyXG4gICAgICAgIGxldCBnYW1lU3RhdHVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKVxyXG4gICAgICAgIGdhbWVTdGF0dXMuY2xhc3NMaXN0LmFkZCgnZ2FtZVN0YXR1cycpXHJcbiAgICAgICAgZ2FtZVN0YXR1cy50ZXh0Q29udGVudCA9ICcnXHJcbiAgICBcclxuICAgICAgICBnYW1lU3RhdHVzQ29udGFpbmVyLmFwcGVuZChnYW1lU3RhdHVzKVxyXG5cclxuICAgICAgICBnYW1lU3RhdHVzQ29udGFpbmVyLmFwcGVuZChyZXNldEJvYXJkQnRuKVxyXG4gICAgICAgIGdhbWVTdGF0dXNDb250YWluZXIuYXBwZW5kKHN0YXJ0R2FtZUJ0bilcclxuICAgICAgICBzdGFydEdhbWUoKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmNvbnN0IHJlc2V0R2FtZSA9ICgpID0+IHtcclxuICAgIGxldCBnYW1lU3RhdHVzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWVTdGF0dXNDb250YWluZXInKVxyXG4gICAgZ2FtZVN0YXR1c0NvbnRhaW5lci5pbm5lckhUTUwgPSAnJ1xyXG5cclxuICAgIGxldCBnYW1lU3RhdHVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKVxyXG4gICAgZ2FtZVN0YXR1cy5jbGFzc0xpc3QuYWRkKCdnYW1lU3RhdHVzJylcclxuICAgIGdhbWVTdGF0dXMudGV4dENvbnRlbnQgPSAnJ1xyXG5cclxuICAgIGdhbWVTdGF0dXNDb250YWluZXIuYXBwZW5kKGdhbWVTdGF0dXMpXHJcblxyXG5cclxuICAgIHBsYXllckJvYXJkLmNsZWFyU2hpcHMoKVxyXG4gICAgYWlCb2FyZC5jbGVhclNoaXBzKClcclxuICAgIHJlc2V0UGxheWVyQm9hcmQoKVxyXG5cclxuICAgIGNsZWFyQm9hcmQoJ3BsYXllcicpXHJcbiAgICBjbGVhckJvYXJkKCdhaScpXHJcbiAgICBkaXNwbGF5Qm9hcmQocGxheWVyQm9hcmQpXHJcbiAgICBkaXNwbGF5Qm9hcmQoYWlCb2FyZClcclxufVxyXG5cclxuZXhwb3J0IHsgZGlzcGxheUJvYXJkLCBwbGF5ZXIsIGFpLCBhaUJvYXJkLCBwbGF5ZXJCb2FyZCwgcmFuZG9tbHlQbGFjZVNoaXBzLCBjbGVhckJvYXJkLCBzdGFydEdhbWUsIGFpQXR0YWNrLCBwbGF5ZXJBdHRhY2ssIHJlc2V0UGxheWVyQm9hcmQgfSIsImltcG9ydCB7IHBsYXlHYW1lLCBkaXNwbGF5Qm9hcmQsIHBsYXllciwgcGxheWVyQm9hcmQsIGFpLCBhaUJvYXJkLCByYW5kb21seVBsYWNlU2hpcHMsIHN0YXJ0R2FtZSwgcmVzZXRQbGF5ZXJCb2FyZCB9IGZyb20gXCIuL2dhbWVcIjtcclxuaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIlxyXG5cclxucmVzZXRQbGF5ZXJCb2FyZCgpO1xyXG5kaXNwbGF5Qm9hcmQocGxheWVyQm9hcmQpO1xyXG5kaXNwbGF5Qm9hcmQoYWlCb2FyZCkiXSwibmFtZXMiOlsiU2hpcCIsImNvbnN0cnVjdG9yIiwibnVtIiwic2hpcE5hbWUiLCJ0aGlzIiwibGVuZ3RoIiwic3VuayIsInNoaXBTdGF0dXMiLCJBcnJheSIsImZpbGwiLCJoaXQiLCJpbmRleCIsIkVycm9yIiwiaXNTdW5rIiwiZXZlcnkiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21EaXJlY3Rpb24iLCJHYW1lYm9hcmQiLCJuYW1lIiwiYm9hcmQiLCJzaGlwcyIsInBsYWNlU2hpcCIsInJvdyIsImNvbCIsImRpcmVjdGlvbiIsImNoZWNrSWZOb3RFbXB0eSIsImN1cnJlbnRTaGlwIiwiaWQiLCJwdXNoIiwiaSIsInNoaXAiLCJzaGlwSW5kZXgiLCJ1bmRlZmluZWQiLCJzaGlwSUQiLCJyZWNlaXZlQXR0YWNrIiwiY2hlY2tTaGlwU3RhdHVzIiwiZWxlbWVudCIsInJlc3VsdCIsImNoZWNrSWZMb3N0IiwiZSIsImNoZWNrRm9yTm9IaXQiLCJhaUF0dGFjayIsImNsZWFyU2hpcHMiLCJQbGF5ZXIiLCJ0dXJuIiwiZ2V0TmFtZSIsInNldE5hbWUiLCJlbmRUdXJuIiwicGxheWVyMiIsInN0YXJ0VHVybiIsImNoZWNrVHVybiIsImF0dGFjayIsIngiLCJ5IiwidGFyZ2V0UGxheWVyIiwidGFyZ2V0Qm9hcmQiLCJwbGF5ZXIiLCJhaSIsInBsYXllckJvYXJkIiwiYWlCb2FyZCIsImRpc3BsYXlCb2FyZCIsImdhbWVib2FyZCIsInBsYXllckJvYXJkQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWlCb2FyZENvbnRhaW5lciIsImgiLCJjZWxsIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsInJlbW92ZSIsImFwcGVuZCIsInJhbmRvbWx5UGxhY2VTaGlwcyIsInNoaXBOYW1lcyIsInNoaXBMZW5ndGhzIiwicGxheWVyQXR0YWNrIiwicGxheWVyMSIsImdhbWVTdGF0dXMiLCJ0ZXh0Q29udGVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNvbnRhaW5zIiwiZ2V0QXR0cmlidXRlIiwiY2xlYXJCb2FyZCIsImRpc3BsYXlXaW5uZXIiLCJzZXRUaW1lb3V0IiwiaW5uZXJIVE1MIiwicGxheWVyTmFtZSIsImdhbWVTdGF0dXNDb250YWluZXIiLCJzdHlsZSIsImZsZXhEaXJlY3Rpb24iLCJyZWxvYWRHYW1lQnRuIiwicmVzZXRHYW1lIiwicmVzZXRQbGF5ZXJCb2FyZCIsInJlc2V0Qm9hcmRCdG4iLCJzdGFydEdhbWVCdG4iLCJkaXNwbGF5Iiwic3RhcnRHYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==