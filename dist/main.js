(()=>{"use strict";class t{constructor(t,s){this.length=t,this.sunk=!1,this.shipStatus=Array(t).fill(""),this.shipName=s}hit(t){if(t<0||t>=this.length)throw new Error("Invalid index");""===this.shipStatus[t]&&(this.shipStatus[t]="hit")}isSunk(){!0===this.shipStatus.every((t=>"hit"===t))&&(this.sunk=!0)}}let s=t=>Math.floor(Math.random()*t),e=()=>0==s(2)?"horizontal":"vertical";class i{constructor(t){this.board=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]],this.ships=[],this.shipsRemaining=null,this.name=t}placeShip(i,r,h,a,l){if("vertical"===a){if(r+i>10||!0===this.checkIfNotEmpty(i,r,h,a))return this.placeShip(i,s(10),s(10),e(),l);let o=new t(i);o.shipName=l,this.ships===[]?o.id=0:o.id=this.ships.length,this.ships.push(o);for(let t=0;t<i;t++){let s={shipIndex:void 0,shipID:o.id};if(console.log(this.board),console.log(this.ships),""!==this.board[r+t][h])throw Error("ship can not be placed here vertically");s.shipIndex=t,this.board[r+t][h]=s}}if("horizontal"===a){if(h+i>10||!0===this.checkIfNotEmpty(i,r,h,a))return this.placeShip(i,s(10),s(10),e(),l);let o=new t(i);o.shipName=l,this.ships===[]?o.id=0:o.id=this.ships.length,this.ships.push(o);for(let t=0;t<i;t++){let s={shipIndex:void 0,shipID:o.id};if(console.log(this.board),console.log(this.ships),""!==this.board[r][h+t])throw Error("ship can not be placed here horizontally");s.shipIndex=t,this.board[r][h+t]=s}}}receiveAttack(t,s){""===this.board[t][s]?this.board[t][s]="miss":"miss"==this.board[t][s]&&""==this.board[t][s]||this.ships[this.board[t][s].shipID].hit(this.board[t][s].shipIndex)}checkShipStatus(){return!!this.ships.every((t=>1==t.sunk))}checkIfNotEmpty(t,s,e,i){let r=!1;if("horizontal"===i&&void 0!==s){for(let i=0;i<t+1;i++)if(""!==this.board[s][e+i]){r=!0;break}return r}if("vertical"===i){let i=!1;for(let r=0;r<t;r++)if(""!==this.board[s+r][e]){i=!0;break}return i}}checkIfLost(){return this.ships.every((t=>1==t.sunk))}}class r{constructor(t){this.name=t,this.turn=!0}getName(){return this.name}setName(t){this.name=t}endTurn(t){1==this.turn&&(this.turn=!1,t.startTurn())}startTurn(){0==this.turn&&(this.turn=!0)}checkTurn(){return this.turn}attack(t,s,e,i){this.checkTurn()&&(i.receiveAttack(t,s),this.endTurn(e))}}const h=new r("player"),a=(new r("ai"),new i("player")),l=new i("ai"),o=t=>{let s=document.querySelector(".playerBoardContainer"),e=document.querySelector(".aiBoardContainer");for(let i=0;i<t.board.length;i++)for(let r=0;r<t.board[i].length;r++){let h=document.createElement("div");h.classList.add("cell"),h.setAttribute("data-row",i),h.setAttribute("data-col",r),"player"==t.name?h.classList.add("playerCell"):"ai"==t.name&&h.classList.add("aiCell"),""!=t.board[i][r]&&"miss"!=t.board[i][r]&&("hit"===t.ships[t.board[i][r].shipID].shipStatus[t.board[i][r].shipIndex]&&h.classList.add("hitCell"),0==t.ships[t.board[i][r].shipID].sunk?h.classList.add("shipCell"):1==t.ships[t.board[i][r].shipID].sunk&&h.classList.add("sunkCell")),"miss"===t.board[i][r]&&h.classList.add("missCell"),"player"==t.name?s.append(h):"ai"==t.name&&e.append(h)}};let n=t=>{let i=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],r=[5,4,3,3,2];for(let h=0;h<5;h++)t.placeShip(r[h],s(10),s(10),e(),i[h])};console.log("hi2"),n(a),console.log(a.board),console.log(a.ships),n(l),console.log(l.board),console.log(l.ships),o(a),o(l),h.startTurn(),((t,s,e)=>{if(1==s.turn){let s=document.querySelectorAll(".aiCell");document.querySelector(".shipCell"),document.querySelector(".hitCell"),document.querySelector(".missCell"),s.forEach((e=>{e.addEventListener("click",(e=>{if(e.target.classList.contains("shipCell")){let i=e.target.getAttribute("data-row"),r=e.target.getAttribute("data-col");console.log("attack"),t.receiveAttack(i,r),s.forEach((t=>{t.removeEventListener()}))}}))}))}})(l,h)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJYSxFQUFZLENBQUMsVUFBVyxhQUFjLFVBQVcsWUFBYSxhQUM5REMsRUFBYyxDQUFDLEVBQUcsRUFBRyxFQUFHLEVBQUcsR0FDL0IsSUFBSyxJQUFJNUMsRUFBSSxFQUFHQSxFQUFJLEVBQUdBLElBQ25COEIsRUFBVXRDLFVBQVVvRCxFQUFZNUMsR0FBSWxCLEVBQWEsSUFBS0EsRUFBYSxJQUFLSSxJQUFtQnlELEVBQVUzQyxHQUN6RyxFQzNESkcsUUFBUUMsSUFBSSxPQUVac0MsRUFBbUJmLEdBQ25CeEIsUUFBUUMsSUFBSXVCLEVBQVl0QyxPQUN4QmMsUUFBUUMsSUFBSXVCLEVBQVlyQyxPQUd4Qm9ELEVBQW1CZCxHQUNuQnpCLFFBQVFDLElBQUl3QixFQUFRdkMsT0FDcEJjLFFBQVFDLElBQUl3QixFQUFRdEMsT0FFcEJ1QyxFQUFhRixHQUNiRSxFQUFhRCxHQUViRixFQUFPUCxZRGdEd0IsRUFBQ1csRUFBV2UsRUFBUzNCLEtBQ2hELEdBQW9CLEdBQWhCMkIsRUFBUS9CLEtBQWMsQ0FDdEIsSUFBSWdDLEVBQVNkLFNBQVNlLGlCQUFpQixXQUN4QmYsU0FBU0MsY0FBYyxhQUN4QkQsU0FBU0MsY0FBYyxZQUN0QkQsU0FBU0MsY0FBYyxhQUd0Q2EsRUFBT0UsU0FBUVosSUFDWEEsRUFBS2EsaUJBQWlCLFNBQVVyQyxJQUNoQyxHQUFJQSxFQUFFc0MsT0FBT1osVUFBVWEsU0FBUyxZQUFhLENBQ3pDLElBQUkxRCxFQUFNbUIsRUFBRXNDLE9BQU9FLGFBQWEsWUFDNUIxRCxFQUFNa0IsRUFBRXNDLE9BQU9FLGFBQWEsWUFDaENqRCxRQUFRQyxJQUFJLFVBQ1owQixFQUFVeEIsY0FBY2IsRUFBS0MsR0FDN0JvRCxFQUFPRSxTQUFRWixJQUNYQSxFQUFLaUIscUJBQW9CLEdBRWpDLElBQ0MsR0FFVCxHQ3BFSkMsQ0FBdUIxQixFQUFTRixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaGVscGVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNoaXAge1xyXG4gICAgY29uc3RydWN0b3IobnVtLCBzaGlwTmFtZSkge1xyXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbnVtO1xyXG4gICAgICAgIHRoaXMuc3VuayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hpcFN0YXR1cyA9IEFycmF5KG51bSkuZmlsbChcIlwiKTtcclxuICAgICAgICB0aGlzLnNoaXBOYW1lID0gc2hpcE5hbWU7XHJcbiAgICB9XHJcblxyXG4gICAgaGl0KGluZGV4KSB7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW5kZXgnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hpcFN0YXR1c1tpbmRleF0gPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hpcFN0YXR1c1tpbmRleF0gPSAnaGl0J1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpc1N1bmsoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hpcFN0YXR1cy5ldmVyeShoaXQgPT4gaGl0ID09PSAnaGl0JykgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgdGhpcy5zdW5rID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IFNoaXAgfSIsImxldCByYW5kb21OdW1iZXIgPSAobnVtKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBudW0pO1xyXG5sZXQgcmFuZG9tRGlyZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgaWYgKHJhbmRvbU51bWJlcigyKSA9PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuICdob3Jpem9udGFsJ1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJ3ZlcnRpY2FsJ1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyByYW5kb21OdW1iZXIsIHJhbmRvbURpcmVjdGlvbiB9IiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcclxuaW1wb3J0IHsgcmFuZG9tTnVtYmVyLCByYW5kb21EaXJlY3Rpb24gfSBmcm9tICcuL2hlbHBlcic7XHJcblxyXG5jbGFzcyBHYW1lYm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBbXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgICAgIFsnJywnJywnJywnJywnJywnJywnJywnJywnJywnJ10sXHJcbiAgICAgICAgXTtcclxuICAgICAgICB0aGlzLnNoaXBzID0gW107XHJcbiAgICAgICAgdGhpcy5zaGlwc1JlbWFpbmluZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBwbGFjZVNoaXAobGVuZ3RoLCByb3csIGNvbCwgZGlyZWN0aW9uLCBzaGlwTmFtZSkge1xyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcclxuICAgICAgICAgICAgaWYgKHJvdyArIGxlbmd0aCA+IDEwIHx8IHRoaXMuY2hlY2tJZk5vdEVtcHR5KGxlbmd0aCwgcm93LCBjb2wsIGRpcmVjdGlvbikgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsYWNlU2hpcChsZW5ndGgsIHJhbmRvbU51bWJlcigxMCksIHJhbmRvbU51bWJlcigxMCksIHJhbmRvbURpcmVjdGlvbigpLCBzaGlwTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzaGlwIGFuZCBwdXNoIGl0IGludG8gc2hpcCBhcnJheVxyXG4gICAgICAgICAgICBsZXQgY3VycmVudFNoaXAgPSBuZXcgU2hpcChsZW5ndGgpO1xyXG4gICAgICAgICAgICBjdXJyZW50U2hpcC5zaGlwTmFtZSA9IHNoaXBOYW1lO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaGlwcyA9PT0gW10pIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTaGlwLmlkID0gMFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFNoaXAuaWQgPSB0aGlzLnNoaXBzLmxlbmd0aDsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaGlwcy5wdXNoKGN1cnJlbnRTaGlwKTtcclxuICAgICAgICAgICAgLy8gYWRkIHNoaXAgdG8gYm9hcmRcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoaXAgPSB7J3NoaXBJbmRleCc6IHVuZGVmaW5lZCwgJ3NoaXBJRCc6IGN1cnJlbnRTaGlwLmlkfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5ib2FyZClcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc2hpcHMpXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtyb3cgKyBpXVtjb2xdID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAuc2hpcEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3JvdyArIGldW2NvbF0gPSBzaGlwO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignc2hpcCBjYW4gbm90IGJlIHBsYWNlZCBoZXJlIHZlcnRpY2FsbHknKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcclxuICAgICAgICAgICAgaWYgKGNvbCArIGxlbmd0aCA+IDEwIHx8IHRoaXMuY2hlY2tJZk5vdEVtcHR5KGxlbmd0aCwgcm93LCBjb2wsIGRpcmVjdGlvbikgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsYWNlU2hpcChsZW5ndGgsIHJhbmRvbU51bWJlcigxMCksIHJhbmRvbU51bWJlcigxMCksIHJhbmRvbURpcmVjdGlvbigpLCBzaGlwTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzaGlwIGFuZCBwdXNoIGl0IGludG8gc2hpcCBhcnJheVxyXG4gICAgICAgICAgICBsZXQgY3VycmVudFNoaXAgPSBuZXcgU2hpcChsZW5ndGgpO1xyXG4gICAgICAgICAgICBjdXJyZW50U2hpcC5zaGlwTmFtZSA9IHNoaXBOYW1lO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaGlwcyA9PT0gW10pIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTaGlwLmlkID0gMFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFNoaXAuaWQgPSB0aGlzLnNoaXBzLmxlbmd0aDsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaGlwcy5wdXNoKGN1cnJlbnRTaGlwKTtcclxuICAgICAgICAgICAgLy8gYWRkIHNoaXAgdG8gYm9hcmRcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNoaXAgPSB7J3NoaXBJbmRleCc6IHVuZGVmaW5lZCwgJ3NoaXBJRCc6IGN1cnJlbnRTaGlwLmlkfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5ib2FyZClcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc2hpcHMpXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZFtyb3ddW2NvbCArIGldID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaXAuc2hpcEluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3Jvd11bY29sICsgaV0gPSBzaGlwO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignc2hpcCBjYW4gbm90IGJlIHBsYWNlZCBoZXJlIGhvcml6b250YWxseScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlY2VpdmVBdHRhY2socm93LCBjb2wpIHtcclxuICAgICAgICBpZiAodGhpcy5ib2FyZFtyb3ddW2NvbF0gPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbcm93XVtjb2xdID0gJ21pc3MnXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmJvYXJkW3Jvd11bY29sXSAhPSAnbWlzcycgfHwgdGhpcy5ib2FyZFtyb3ddW2NvbF0gIT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGlwc1t0aGlzLmJvYXJkW3Jvd11bY29sXS5zaGlwSURdLmhpdCh0aGlzLmJvYXJkW3Jvd11bY29sXS5zaGlwSW5kZXgpIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja1NoaXBTdGF0dXMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hpcHMuZXZlcnkoZWxlbWVudCA9PiBlbGVtZW50LnN1bmsgPT0gdHJ1ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9IGVsc2UgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tJZk5vdEVtcHR5KGxlbmd0aCwgcm93LCBjb2wsIGRpcmVjdGlvbikge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcgJiYgcm93ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGggKzE7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRbcm93XVtjb2wgKyBpXSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgfSByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkW3JvdyArIGldW2NvbF0gIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIH0gcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9ICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrSWZMb3N0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoaXBzLmV2ZXJ5KGUgPT4gZS5zdW5rID09IHRydWUpO1xyXG4gICAgICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgR2FtZWJvYXJkIH0iLCJjbGFzcyBQbGF5ZXIge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLnR1cm4gPSB0cnVlO1xyXG4gIH1cclxuICBnZXROYW1lKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubmFtZTtcclxuICB9XHJcbiAgc2V0TmFtZShuYW1lKSB7XHJcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gIH1cclxuICBlbmRUdXJuKHBsYXllcjIpIHtcclxuICAgIGlmICh0aGlzLnR1cm4gPT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLnR1cm4gPSBmYWxzZTtcclxuICAgICAgcGxheWVyMi5zdGFydFR1cm4oKTtcclxuICAgIH1cclxuICB9XHJcbiAgc3RhcnRUdXJuKCkge1xyXG4gICAgaWYgKHRoaXMudHVybiA9PSBmYWxzZSkge1xyXG4gICAgICB0aGlzLnR1cm4gPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuICBjaGVja1R1cm4oKSB7XHJcbiAgICByZXR1cm4gdGhpcy50dXJuO1xyXG4gIH1cclxuICBhdHRhY2soeCwgeSwgdGFyZ2V0UGxheWVyLCB0YXJnZXRCb2FyZCkge1xyXG4gICAgaWYgKHRoaXMuY2hlY2tUdXJuKCkpIHtcclxuICAgICAgdGFyZ2V0Qm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcclxuICAgICAgdGhpcy5lbmRUdXJuKHRhcmdldFBsYXllcik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBQbGF5ZXIgfSIsImltcG9ydCB7IEdhbWVib2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgcmFuZG9tRGlyZWN0aW9uLCByYW5kb21OdW1iZXIgfSBmcm9tIFwiLi9oZWxwZXJcIjtcclxuXHJcbmNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoJ3BsYXllcicpO1xyXG5jb25zdCBhaSA9IG5ldyBQbGF5ZXIoJ2FpJyk7XHJcblxyXG5jb25zdCBwbGF5ZXJCb2FyZCA9IG5ldyBHYW1lYm9hcmQoJ3BsYXllcicpO1xyXG5jb25zdCBhaUJvYXJkICA9IG5ldyBHYW1lYm9hcmQoJ2FpJyk7XHJcblxyXG5jb25zdCBkaXNwbGF5Qm9hcmQgPSAoZ2FtZWJvYXJkKSA9PiB7XHJcblxyXG4gICAgbGV0IHBsYXllckJvYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllckJvYXJkQ29udGFpbmVyJyk7XHJcbiAgICBsZXQgYWlCb2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5haUJvYXJkQ29udGFpbmVyJyk7XHJcblxyXG4gICAgZm9yIChsZXQgaCA9IDA7IGggPCBnYW1lYm9hcmQuYm9hcmQubGVuZ3RoOyBoKyspIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVib2FyZC5ib2FyZFtoXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xyXG4gICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdkYXRhLXJvdycsIGgpXHJcbiAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJywgaSlcclxuXHJcbiAgICAgICAgLy8gY2hhbmdlIGNvbG9yIG9mIGJvYXJkIGJhc2VkIG9uIHdobyB0aGUgcGxheWVyIGlzXHJcbiAgICAgICAgaWYgKGdhbWVib2FyZC5uYW1lID09ICdwbGF5ZXInKSB7XHJcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgncGxheWVyQ2VsbCcpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZ2FtZWJvYXJkLm5hbWUgPT0gJ2FpJykge1xyXG4gICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2FpQ2VsbCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGdhbWVib2FyZC5ib2FyZFtoXVtpXSAhPSAnJyAmJiBnYW1lYm9hcmQuYm9hcmRbaF1baV0gIT0gJ21pc3MnKSB7XHJcbiAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuc2hpcHNbZ2FtZWJvYXJkLmJvYXJkW2hdW2ldLnNoaXBJRF0uc2hpcFN0YXR1c1tnYW1lYm9hcmQuYm9hcmRbaF1baV0uc2hpcEluZGV4XSA9PT0gJ2hpdCcpIHtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGl0Q2VsbCcpXHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLnNoaXBzW2dhbWVib2FyZC5ib2FyZFtoXVtpXS5zaGlwSURdLnN1bmsgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnc2hpcENlbGwnKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGdhbWVib2FyZC5zaGlwc1tnYW1lYm9hcmQuYm9hcmRbaF1baV0uc2hpcElEXS5zdW5rID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnc3Vua0NlbGwnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKGdhbWVib2FyZC5ib2FyZFtoXVtpXSA9PT0gJ21pc3MnKSB7XHJcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzc0NlbGwnKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoZ2FtZWJvYXJkLm5hbWUgPT0gJ3BsYXllcicpIHtcclxuICAgICAgICAgICAgcGxheWVyQm9hcmRDb250YWluZXIuYXBwZW5kKGNlbGwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZ2FtZWJvYXJkLm5hbWUgPT0gJ2FpJykge1xyXG4gICAgICAgICAgICBhaUJvYXJkQ29udGFpbmVyLmFwcGVuZChjZWxsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxubGV0IHJhbmRvbWx5UGxhY2VTaGlwcyA9IChnYW1lYm9hcmQpID0+IHtcclxuICAgIGxldCBzaGlwTmFtZXMgPSBbXCJDYXJyaWVyXCIsIFwiQmF0dGxlc2hpcFwiLCBcIkNydWlzZXJcIiwgXCJTdWJtYXJpbmVcIiwgXCJEZXN0cm95ZXJcIl1cclxuICAgIGxldCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBMZW5ndGhzW2ldLCByYW5kb21OdW1iZXIoMTApLCByYW5kb21OdW1iZXIoMTApLCByYW5kb21EaXJlY3Rpb24oKSwgc2hpcE5hbWVzW2ldKVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBhZGRCb2FyZEV2ZW50TGlzdGVuZXJzID0gKGdhbWVib2FyZCwgcGxheWVyMSwgcGxheWVyMikgPT4ge1xyXG4gICAgaWYgKHBsYXllcjEudHVybiA9PSB0cnVlKSB7XHJcbiAgICAgICAgbGV0IGFpQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5haUNlbGwnKVxyXG4gICAgICAgIGxldCBzaGlwQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaGlwQ2VsbCcpXHJcbiAgICAgICAgbGV0IGhpdENlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGl0Q2VsbCcpXHJcbiAgICAgICAgbGV0IG1pc3NDZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1pc3NDZWxsJylcclxuXHJcblxyXG4gICAgICAgIGFpQ2VsbC5mb3JFYWNoKGNlbGwgPT4ge1xyXG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2hpcENlbGwnKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1yb3cnKVxyXG4gICAgICAgICAgICAgICAgbGV0IGNvbCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1jb2wnKVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2F0dGFjaycpXHJcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhyb3csIGNvbClcclxuICAgICAgICAgICAgICAgIGFpQ2VsbC5mb3JFYWNoKGNlbGwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNlbGwucmVtb3ZlRXZlbnRMaXN0ZW5lcigpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuY29uc3Qgc3RhcnRHYW1lID0gKCkgPT4ge1xyXG4gICAgcmFuZG9tbHlQbGFjZVNoaXBzKGFpQm9hcmQpXHJcblxyXG5cclxufVxyXG5cclxuZXhwb3J0IHsgZGlzcGxheUJvYXJkLCBwbGF5ZXIsIGFpLCBhaUJvYXJkLCBwbGF5ZXJCb2FyZCwgcmFuZG9tbHlQbGFjZVNoaXBzLCBhZGRCb2FyZEV2ZW50TGlzdGVuZXJzIH0iLCJpbXBvcnQgeyBwbGF5R2FtZSwgZGlzcGxheUJvYXJkLCBwbGF5ZXIsIHBsYXllckJvYXJkLCBhaSwgYWlCb2FyZCwgcmFuZG9tbHlQbGFjZVNoaXBzLCBhZGRCb2FyZEV2ZW50TGlzdGVuZXJzIH0gZnJvbSBcIi4vZ2FtZVwiO1xyXG5pbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiXHJcblxyXG5jb25zb2xlLmxvZygnaGkyJyk7IFxyXG5cclxucmFuZG9tbHlQbGFjZVNoaXBzKHBsYXllckJvYXJkKTtcclxuY29uc29sZS5sb2cocGxheWVyQm9hcmQuYm9hcmQpO1xyXG5jb25zb2xlLmxvZyhwbGF5ZXJCb2FyZC5zaGlwcyk7XHJcblxyXG5cclxucmFuZG9tbHlQbGFjZVNoaXBzKGFpQm9hcmQpO1xyXG5jb25zb2xlLmxvZyhhaUJvYXJkLmJvYXJkKTtcclxuY29uc29sZS5sb2coYWlCb2FyZC5zaGlwcyk7XHJcblxyXG5kaXNwbGF5Qm9hcmQocGxheWVyQm9hcmQpO1xyXG5kaXNwbGF5Qm9hcmQoYWlCb2FyZCk7XHJcblxyXG5wbGF5ZXIuc3RhcnRUdXJuKCk7XHJcbmFkZEJvYXJkRXZlbnRMaXN0ZW5lcnMoYWlCb2FyZCwgcGxheWVyLCBhaSkiXSwibmFtZXMiOlsiU2hpcCIsImNvbnN0cnVjdG9yIiwibnVtIiwic2hpcE5hbWUiLCJ0aGlzIiwibGVuZ3RoIiwic3VuayIsInNoaXBTdGF0dXMiLCJBcnJheSIsImZpbGwiLCJoaXQiLCJpbmRleCIsIkVycm9yIiwiaXNTdW5rIiwiZXZlcnkiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21EaXJlY3Rpb24iLCJHYW1lYm9hcmQiLCJuYW1lIiwiYm9hcmQiLCJzaGlwcyIsInNoaXBzUmVtYWluaW5nIiwicGxhY2VTaGlwIiwicm93IiwiY29sIiwiZGlyZWN0aW9uIiwiY2hlY2tJZk5vdEVtcHR5IiwiY3VycmVudFNoaXAiLCJpZCIsInB1c2giLCJpIiwic2hpcCIsInVuZGVmaW5lZCIsImNvbnNvbGUiLCJsb2ciLCJzaGlwSW5kZXgiLCJyZWNlaXZlQXR0YWNrIiwic2hpcElEIiwiY2hlY2tTaGlwU3RhdHVzIiwiZWxlbWVudCIsInJlc3VsdCIsImNoZWNrSWZMb3N0IiwiZSIsIlBsYXllciIsInR1cm4iLCJnZXROYW1lIiwic2V0TmFtZSIsImVuZFR1cm4iLCJwbGF5ZXIyIiwic3RhcnRUdXJuIiwiY2hlY2tUdXJuIiwiYXR0YWNrIiwieCIsInkiLCJ0YXJnZXRQbGF5ZXIiLCJ0YXJnZXRCb2FyZCIsInBsYXllciIsInBsYXllckJvYXJkIiwiYWlCb2FyZCIsImRpc3BsYXlCb2FyZCIsImdhbWVib2FyZCIsInBsYXllckJvYXJkQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWlCb2FyZENvbnRhaW5lciIsImgiLCJjZWxsIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZCIsInJhbmRvbWx5UGxhY2VTaGlwcyIsInNoaXBOYW1lcyIsInNoaXBMZW5ndGhzIiwicGxheWVyMSIsImFpQ2VsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNvbnRhaW5zIiwiZ2V0QXR0cmlidXRlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZEJvYXJkRXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9